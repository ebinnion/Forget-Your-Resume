/*
 * jQuery UI Font Selector Widget
 *
 * Copyright 2012, Olav Andreas Lindekleiv (http://lindekleiv.com/)
 * Available under the BSD License
 * See the LICENSE file or http://opensource.org/licenses/BSD-3-Clause
 *
 * Available on BitBucket at
 * https://bitbucket.org/lindekleiv/jquery-ui-fontselector
 */

$.widget("oal.fontSelector",{options:{inSpeed:500,outSpeed:250,bold:false,italic:false,underline:false},_create:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this;this.element.hide();e=[];k=this.element.children();for(g=0,i=k.length;g<i;g++){a=k[g];c=$(a).text();d=$(a).attr("value");if($(a).attr("selected"))this.selected=d;e.push([d,c])}if(!this.selected)this.selected=e[0][0];this.dropdown=$('<div class="fontSelector ui-widget"><span class="handle">&#9660;</span></div>');this.list=$('<ul class="fonts"></ul>');for(h=0,j=e.length;h<j;h++){a=e[h];l=a,a=l[0],f=l[1];this.element.before("<link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family="+a+":400,700,400italic,700italic'></link>");b=$("<li style=\"font-family: '"+a+"'\">"+f+"</li>");b.data("font",a);if(a===this.selected){b.addClass("selected");this.dropdown.prepend($("<h4 style=\"font-family: '"+a+"'\" class='selected handle'>"+f+"</h4>"))}this.list.append(b)}this.dropdown.append(this.list);this.element.after(this.dropdown);return $("div.fontSelector .handle").click(function(){return m._toggleOpen()})},_toggleOpen:function(){var a=this;if(this.list.is(":visible")){this.dropdown.find("span.handle").html("&#9660;");return this.list.slideUp(this.options.outSpeed)}else{this.dropdown.find("span.handle").html("&#9650;");this.list.slideDown(this.options.inSpeed);return $("div.fontSelector ul.fonts li").click(function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o;c=$(b.target).data("font");g=$(b.target).text();h=a.selected;if(c===h)return false;a._trigger("fontChange",null,{font:c,oldFont:h});a.selected=c;$("div.fontSelector h4.selected").text(g).css({fontFamily:c});m=a.list.children();for(i=0,k=m.length;i<k;i++){d=m[i];if($(d).data("font")===c){$(d).addClass("selected")}else if($(d).data("font")===h){$(d).removeClass("selected")}}n=a.element.children();o=[];for(j=0,l=n.length;j<l;j++){f=n[j];e=$(f).val();if(e===c){o.push($(f).attr("selected","selected"))}else{o.push(void 0)}}return o})}},_setOption:function(a,b){if(a==="bold"&&(b===true||b===false)){this.options.bold=b;if(b===true){this.dropdown.find("h4.selected").css({fontWeight:"bold"});this.list.css({fontWeight:"bold"})}else{this.dropdown.find("h4.selected").css({fontWeight:"normal"});this.list.css({fontWeight:"normal"})}}else if(a==="italic"&&(b===true||b===false)){this.options.italic=b;if(b===true){this.dropdown.find("h4.selected").css({fontStyle:"italic"});this.list.css({fontStyle:"italic"})}else{this.dropdown.find("h4.selected").css({fontStyle:"normal"});this.list.css({fontStyle:"normal"})}}else if(a==="underline"&&(b===true||b===false)){this.options.underline=b;if(b===true){this.dropdown.find("h4.selected").css({textDecoration:"underline"});this.list.css({textDecoration:"underline"})}else{this.dropdown.find("h4.selected").css({textDecoration:"none"});this.list.css({textDecoration:"none"})}}if((a==="bold"||a==="italic"||a==="underline")&&(b===true||b===false)){return this._trigger("styleChange",null,{style:a,value:b})}},destroy:function(){return Widget.prototype.destroy.call(this)}})